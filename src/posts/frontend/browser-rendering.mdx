import { Callout, Tooltip } from '../../components/mdx'

export const metadata = {
  pinned: false,
  title: '브라우저 렌더링 원리',
  description: '렌더링 원리를 알면 성능(특히 레이아웃/페인트 비용), UX/Core Web Vitals, 디버깅, 아키텍처 결과 등을 최적화할 수 있어요.',
  publishDate: "2025-07-18T19:24:06Z",
  image: '',
  tags: [
    'Frontend', 'Rendering', 'Browser'
  ],
};

# 렌더링이란?
쉽게 말해, 우리가 **웹사이트를 열었을 때 그 안에 있는 내용이 어떻게 화면에 나타나는지를 결정하는 과정**이라고 할 수 있어요.

브라우저마다 다르지만, 브라우저는 렌더링을 수행하는 **렌더링 엔진**을 가지고 있어요.
크롬은 블링크*Blink*, 사파리는 웹킷*Webkit* 그리고 파이어폭스는 게코*Gecko*라는 렌더링 엔진을 사용해요.

렌더링 엔진이 HTML, CSS, Javascript로 렌더링할 때<Tooltip word="CRP(Critical Rendering Path)" title="중요 렌더링 경로">브라우저가 HTML, CSS, Javascipt를 화면에 픽셀로 전환되는 일련의 단계를 뜻해요.</Tooltip>라는 프로세스를 사용하며 다음 단계들을 거쳐요.

---
# 렌더링 단계
## 1. HTML 파싱
- HTML <Tooltip word="파싱" title="파싱">문서의 내용을 **토큰(token)으로 분석**하고, 문법적 의미와 구조를 반영한 **파스 트리(parse tree)를 생성**하는 과정을 말해요.</Tooltip>은, **브라우저가 HTML 문서를 읽고 이해하는 과정**이에요.
- 이 단계에서 브라우저는 HTML을 <Tooltip word="DOM(Document Object Model)" title="문서 객체 모델">**웹페이지의 구조(HTML 문서)를 트리 형태의 객체로 표현**한 것이에요. DOM은 HTML과 스크립팅 언어(JavaScript)를 서로 이어 주는 역할을 해서 HTML 요소를 추가하거나, 수정하거나, 삭제할 수 있어요.</Tooltip> 트리로 변환해요.

## 2. CSS 파싱
- CSS 파싱은 **CSS 파일을 읽고 해석하는 과정**이에요.
- 이 단계에서 브라우저는 CSS 규칙을 분석하여 <Tooltip word="CSSOM(CSS Object Model)" title="CSS 객체 모델">CSS 내용을 파싱하여 자료를 구조화 한 것이에요. 즉, DOM처럼 **CSS의 내용을 해석하고 노드를 만들어 트리 구조로 만든 것**을 CSSOM이라 해요.</Tooltip> 트리를 생성해요.

## 3. 렌더 트리 생성
- DOM과 CSSOM을 결합하여 <Tooltip word="렌더 트리" title="렌더 트리">**CSSOM과 DOM 트리의 결합**으로 만들어져요. 웹 페이지에 나타낼 각 요소들의 **위치(Layout)을 계산**하는데 사용되고 픽셀을 화면에 렌더링하는 페인트(Paint), **화면에 요소들을 표현하는 프로세스를 위해 존재**해요.</Tooltip>를 생성해요.
- 이 렌더 트리는 실제로 화면에 표시될 요소들만 포함하고 있어, `display: none` 속성과 같이 화면에서 보이지도 않고 공간을 차지하지 않는 것은 렌더트리로 구축되지 않아요.

## 4. 레이아웃 (리플로우)
- 렌더 트리를 기반으로 각 요소의 위치와 크기를 계산해요.
- 이 단계에서는 각 요소가 화면에서 어디에 위치할지를 결정해요.
   
## 5. 페인팅 (래스터화)
- 레이아웃 단계에서 계산된 정보를 바탕으로 실제로 화면에 요소를 그리는 단계에요.
- 이 단계에서는 색상, 텍스트, 이미지 등이 화면에 그려져요.

## 6. 컴포지팅
- 마지막으로, 모든 요소가 화면에 올바르게 표시되도록 레이어를 결합해요.
- 이 단계에서 최종적으로 사용자가 보는 화면이 완성돼요.

## 요약
-  **서버에서 받은 HTML/CSS를 파싱해 DOM·CSSOM을 만들고 이를 결합한 렌더 트리로 화면을 그려요.**
-  다만, 파싱 중 `<script>`를 만나면 진행 중이던 **DOM 생성을 중단**하기 때문에, `<script>`는 보편적으로 `<body>` 태그 밑에 두는 것이 좋아요. 상단에 위치해야 한다면 `defer`, `async` 문법을 통해서 **비동기적으로 처리**할 수 있어요.
-  `<style>`이나 `<link>` 태그를 만나도 DOM 생성을 중단하고, CSSOM을 생성해요.

# HTML 렌더링 중 JavaScript가 실행되면 렌더링이 멈추는 이유
HTML을 파싱하다가 `<script>`를 만나면, **렌더링 엔진이 파싱을 멈추고 자바스크립트 엔진이 실행**을 맡아요.
이유는 **자바스크립트가 DOM/CSSOM을 변경할 수 있기 때문**이에요.

## 동작 과정

1. **렌더링 엔진(예: Blink, Webkit)**
    - HTML을 위에서 아래로 읽으면서 DOM을 만들어요.
    - CSS를 만나면 CSSOM을 만들어요.

2. **자바스크립트 실행 시점**
    - `<script>` 태그를 만나면 **브라우저는 파싱을 멈추고 JS 엔진에 제어권을 넘겨요.**
    - 왜냐하면, 자바스크립트가 `document.write`, DOM 조작, 스타일 변경 같은 작업으로 **지금까지 만든 DOM/CSSOM을 바꿀 수 있기 때문**이에요.

3. 렌더링 재개
    - JS 실행이 끝난 뒤 다시 렌더링 엔진이 돌아와서 DOM/CSSOM 파싱을 이어가요.

## 예시 코드
이 코드는 `<script>` 실행 시 DOM을 통째로 바꿔버려서, 뒤의 `<p>두 번째 문장</p>`는 아예 사라져요.
그래서 브라우저는 **혹시 DOM이 바뀔지도 모르니까 렌더링을 멈추고 JS부터 실행**하는 거예요.

```js
<p>첫 번째 문장</p>
<script>
  document.body.innerHTML = "<h1>변경!</h1>";
</script>
<p>두 번째 문장</p>
```
---
# 렌더링 최적화
렌더링 성능을 향상시키기 위해 몇 가지 방법이 있어요.

1. **CSS와 JavaScript 파일 최적화**
불필요한 코드나 중복된 스타일을 제거하여 파일 크기를 줄이는 것이 중요해요.
    - 번들링·압축(Webpack, Vite, Rollup)
    - 코드 스플리팅(Code Splitting)

2. **비동기 로딩**
JavaScript 파일을 비동기로 로드하면 페이지 로딩 속도를 개선할 수 있어요.
    - `<script defer>` 또는 `<script async>` 속성 사용
    - `<body>` 태그 끝부분에 `<script>`배치 → HTML 파싱이 끝난 후 실행

3. **이미지 최적화**
이미지 파일의 크기를 줄이고, 적절한 포맷을 사용하여 로딩 시간을 단축할 수 있어요.
    - WebP/AVIF 같은 최신 포맷 사용
    - Lazy Loading (loading="lazy")
    - CDN(Content Delivery Network) 활용

4. **렌더링 차단 리소스 최소화**
CSS와 JavaScript 파일이 렌더링을 차단하지 않도록 최적화하는 것이 중요해요.
    - Critical CSS 인라인 처리
    - 필요 없는 JS는 지연 로딩(dynamic import)
---

# 참고
- [Medium, 브라우저의 렌더링 과정](https://medium.com/%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%9D%98%ED%92%88%EA%B2%A9/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EC%9D%98-%EB%A0%8C%EB%8D%94%EB%A7%81-%EA%B3%BC%EC%A0%95-5c01c4158ce),
- [Github, 브라우저의 렌더링 원리](https://github.com/baeharam/Must-Know-About-Frontend/blob/main/Notes/frontend/browser-rendering.md)
- [Blog, 브라우저 렌더링 원리에 대해 설명해 주세요](https://velog.io/@gonasooc/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EB%A0%8C%EB%8D%94%EB%A7%81-%EC%9B%90%EB%A6%AC%EC%97%90-%EB%8C%80%ED%95%B4-%EC%84%A4%EB%AA%85%ED%95%B4%EC%A3%BC%EC%84%B8%EC%9A%94)
