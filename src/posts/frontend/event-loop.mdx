import { Tooltip } from '../../components/mdx'

export const metadata = {
  pinned: false,
  title: '이벤트 루프(Event Loop)란?',
  description: '이벤트 루프(Event Loop)는 자바스크립트가 싱글 스레드임에도 여러 작업을 동시에 처리하는 것처럼 보이게 하는 핵심 메커니즘이에요.',
  publishDate: "2025-08-23T18:21:40Z",
  image: '',
  tags: [
    'Frontend', 'JavaScript', 'EventLoop'
  ],
};

# 이벤트 루프란?
자바스크립트 엔진은 **콜 스택(Call Stack)** 에서 코드 실행을 담당해요.
하지만 네트워크 요청, 타이머, Promise 같은 **비동기 작업도 관리**해야 하는데, 이를 위해 **실행 순서를 조율하는 것이 이벤트 루프**예요.
이벤트 루프는 항상 **콜 스택이 비었는지를 확인**하고, **비었다면 큐에서 새로운 작업을 가져와 실행**해요.

# 동작 과정
## 1. 콜 스택(Call Stack)
- 현재 실행 중인 함수들이 쌓이는 곳이에요.  
- 동기 함수는 즉시 실행되고, 끝나면 스택에서 제거돼요.

## 2. Web APIs (브라우저 제공 기능)
- `setTimeout`, DOM 이벤트, `fetch` 같은 비동기 작업을 브라우저가 담당해요.  
- 작업이 완료되면 콜백을 큐에 넣어요.

## 3. 마이크로태스크 큐(Microtask Queue)
- `Promise.then`, `catch`, `finally`, `queueMicrotask` 같은 작업이 들어와요.  
- **태스크 큐보다 우선순위가 높아서**, 콜 스택이 비면 먼저 전부 실행돼요.

## 4. 태스크 큐(Task Queue)
- 완료된 비동기 콜백(`setTimeout`, DOM 이벤트 등)이 들어오는 대기열이에요.  
- 이벤트 루프는 마이크로태스크가 모두 비워진 뒤 태스크 큐에서 작업을 꺼내 실행해요.

## 5. 이벤트 루프(Event Loop)
- 콜 스택이 비었는지 계속 확인하다가, 비면  
   - 먼저 **마이크로태스크 큐** 전부 실행  
   - 이후 **태스크 큐**에서 콜백을 꺼내 실행해요.

이 덕분에 자바스크립트는 **싱글 스레드지만 멈추지 않고 여러 작업을 처리**할 수 있어요.

# 실행 흐름
```js
console.log("A");

setTimeout(() => {
  console.log("태스크 큐");
}, 100);

Promise.resolve().then(() => {
  console.log("마이크로태스크 큐");
});

console.log("C");
```

**실행 결과**
```plainText
A
C
마이크로태스크
태스크 큐
```

1. `A` → **콜 스택에서 바로 실행**돼요.
2. `setTimeout` → **Web API**로 보내지고, `100ms` 타이머 카운트를 시작해요.
3. `Promise.then` → **마이크로태스크 큐**에 콜백이 들어가요.
4. `C` → **콜 스택에서 바로 실행**돼요.
5. **이벤트 루프**가 **콜 스택이 비어 있는 걸 확인**하면, **마이크로태스크 큐 먼저 실행**해요.
6. `100ms`가 지나면, **Web API**가 `setTimeout` 콜백을 **태스크 큐로 이동**시켜요.
7. **이벤트 루프**가 **콜 스택이 비어 있는 걸 확인**하면, **태스크 큐에서 콜백을 꺼내 실행**해요.